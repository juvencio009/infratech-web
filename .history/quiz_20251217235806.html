<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Gteste | Prova</title>

  <!-- Bootstrap Icons -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    rel="stylesheet"
  >

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: Arial, Helvetica, sans-serif;
    }

    body {
      background: #f4f6f8;
      color: #1f2937;
    }

    header {
      background: #ffffff;
      border-bottom: 1px solid #e5e7eb;
      padding: 16px 40px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .logo {
      font-size: 22px;
      font-weight: bold;
      color: #1d4ed8;
      cursor: pointer;
    }

    main {
      max-width: 720px;
      margin: 40px auto;
      background: #ffffff;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      padding: 30px;
    }

    h2 {
      margin-bottom: 10px;
    }

    .subtitle {
      color: #6b7280;
      margin-bottom: 20px;
      font-size: 14px;
    }

    /* INTRO */
    #intro ul {
      margin: 20px 0;
      padding-left: 18px;
      color: #374151;
    }

    #intro li {
      margin-bottom: 8px;
      font-size: 14px;
    }

    button {
      background: #1d4ed8;
      color: #ffffff;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }

    button:hover {
      background: #1e40af;
    }

    /* QUIZ */
    .question-number {
      font-size: 13px;
      color: #6b7280;
      margin-bottom: 6px;
    }

    .question-text {
      font-size: 17px;
      margin-bottom: 20px;
    }

    .option {
      border: 1px solid #e5e7eb;
      border-radius: 4px;
      padding: 10px 12px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: 0.15s;
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .option:hover {
      background: #f9fafb;
    }

    .option input {
      cursor: pointer;
    }

    .actions {
      margin-top: 20px;
      display: flex;
      justify-content: flex-end;
    }

    /* RESULTADO */
    #resultado {
      text-align: center;
    }

    .score {
      font-size: 28px;
      margin: 20px 0;
      color: #1d4ed8;
    }

    .status {
      font-size: 16px;
      font-weight: bold;
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>

<header>
  <div class="logo" onclick="location.href='index.html'">Gteste</div>
</header>

<main>

  <!-- INTRO -->
  <section id="intro">
    <h2 id="disciplina">Prova</h2>
    <p class="subtitle">
      Simulação de exame de admissão universitária
    </p>

    <ul>
      <li><i class="bi bi-exclamation-triangle"></i> Não é possível voltar questões</li>
      <li><i class="bi bi-exclamation-triangle"></i> Apenas uma alternativa correta</li>
      <li><i class="bi bi-exclamation-triangle"></i> Resultado exibido apenas no final</li>
    </ul>

    <button id="startBtn">
      <i class="bi bi-play-fill"></i> Iniciar prova
    </button>
  </section>

  <!-- QUIZ -->
  <section id="quiz" class="hidden">
    <div class="question-number" id="qNumber"></div>
    <div class="question-text" id="pergunta"></div>

    <form id="respostas"></form>

    <div class="actions">
      <button type="button" id="submitBtn">
        Submeter resposta
      </button>
    </div>
  </section>

  <!-- RESULTADO -->
  <section id="resultado" class="hidden"></section>

</main>
<script>
  const params = new URLSearchParams(window.location.search);
  const disciplina = params.get("disciplina");

  const intro = document.getElementById("intro");
  const quiz = document.getElementById("quiz");
  const resultado = document.getElementById("resultado");

  document.getElementById("disciplina").innerText =
    disciplina ? disciplina.toUpperCase() : "Prova";

  let questoes = [];
  let atual = 0;
  let score = 0;

  // carregar JSON
  fetch(`data/${disciplina}.json`)
    .then(r => {
      if (!r.ok) throw new Error("JSON não encontrado");
      return r.json();
    })
    .then(data => {
      questoes = data;
    })
    .catch(() => {
      alertG("Erro ao carregar questões.");
    });

  document.getElementById("startBtn").onclick = () => {
    if (!questoes.length) {
      alertG("Questões ainda não carregaram.");
      return;
    }

    intro.classList.add("hidden");
    quiz.classList.remove("hidden");
    renderQuestao();
  };

  function renderQuestao() {
    const q = questoes[atual];

    document.getElementById("qNumber").innerText =
      `Questão ${atual + 1} de ${questoes.length}`;

    document.getElementById("pergunta").innerText = q.pergunta;

    const box = document.getElementById("respostas");
    box.innerHTML = "";

    q.respostas.forEach((r, i) => {
      box.innerHTML += `
        <label class="option">
          <input type="radio" name="resp" value="${i}">
          ${r}
        </label>
      `;
    });
  }

  document.getElementById("submitBtn").onclick = () => {
    const marcada = document.querySelector('input[name="resp"]:checked');
    if (!marcada) {
      alertG("Selecione uma alternativa.");
      return;
    }

    if (parseInt(marcada.value) === questoes[atual].correta) {
      score++;
    }

    atual++;

    if (atual < questoes.length) {
      renderQuestao();
    } else {
      finalizar();
    }
  };

  function finalizar() {
    quiz.classList.add("hidden");
    resultado.classList.remove("hidden");

    const nota20 = Math.round((score / questoes.length) * 20);

    resultado.innerHTML = `
      <h2>Resultado final</h2>
      <div class="score">${nota20} / 20</div>
      <div class="status">
        ${nota20 >= 10 ? "APROVADO" : "REPROVADO"}
      </div>
    `;
  }
const historico = JSON.parse(localStorage.getItem("gteste_historico")) || [];

historico.push({
  disciplina: disciplina.toUpperCase(),
  data: new Date().toLocaleString(),
  nota: nota20,
  status: nota20 >= 10 ? "Aprovado" : "Reprovado"
});

localStorage.setItem("gteste_historico", JSON.stringify(historico));


function alertG(text,state='info'){

  const div = document.createElement("div");
  div.style.cssText=`
  position:absolute;
  top:90px;
  left:50%;
  transform:translateX(-50%);
  max-width:200px;
  border-radius:20px;
  padding:10px 12px;
  background:${state==='info'?'#dbb612':'#1d4ed8'};
  color:#233;
  box-shadow:0 13px 20px rgba(0,0,0,0.05);
  z-index:2;
  border:1px solid #fafaee;
  `;
  div.textContent=text;
  document.body.appendChild(div);

  setTimeout(()=>{
    div.style.cssText=`
    `
  },3000)
}


</script>

</body>
</html>
